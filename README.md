## Конвертер TOML в учебный конфигурационный язык


### 1. Общее описание

Этот проект представляет собой инструмент командной строки, который преобразует входные данные в формате TOML в выходной формат учебного конфигурационного языка. Программа читает TOML из стандартного ввода и записывает преобразованный текст в указанный выходной файл. В случае синтаксических ошибок программа выводит соответствующие сообщения об ошибках.

**Основные возможности:**
- Преобразование чисел, строк, массивов и словарей из TOML в учебный конфигурационный язык.
- Обработка константных выражений на этапе трансляции (объявление и вычисление констант).
- Валидация имен в соответствии с заданным синтаксисом.
- Обработка вложенных структур данных.
- Покрытие всех функциональных возможностей тестами с использованием pytest.


### 2. Описание функций и настроек

#### Файл converter.py

    Класс Converter

    Отвечает за преобразование данных из формата TOML в учебный конфигурационный язык.

    Методы:
    - __init__(self): Инициализирует объект конвертера и создает словарь для хранения констант.
    - convert_value(self, value, indent_level=0): Рекурсивно преобразует значение value в соответствующий синтаксис учебного конфигурационного языка.

        Параметры:
        - value: Значение для преобразования (число, строка, список, словарь и т.д.).
        - indent_level: Уровень отступа для форматирования вложенных структур.

    Возвращает: Строковое представление значения в формате учебного конфигурационного языка.

    - convert_constant_value(self, val_str, indent_level): Обрабатывает значение константы при ее объявлении.

        Параметры:
        - val_str: Строковое представление значения константы.
        - indent_level: Уровень отступа для форматирования.
    
    Возвращает: Строковое представление значения константы.
---
    Функции верхнего уровня

    - parse_args(): Разбирает аргументы командной строки и возвращает объект с параметрами.

        Аргументы:
        -  -o или --output: Путь к выходному файлу (обязательный параметр).

    - read_toml_input(): Читает TOML-данные из стандартного ввода и парсит их с помощью модуля toml.

    - main(): Основная функция программы, которая объединяет все этапы: разбор аргументов, чтение входных данных, преобразование и запись результата.

#### Файл test_converter.py

Содержит набор тестов для класса Converter, написанных с использованием pytest. Тесты покрывают все конструкции учебного конфигурационного языка, включая:
- Преобразование чисел.
- Преобразование строк.
- Преобразование массивов.
- Преобразование словарей.
- Обработку вложенных структур.
- Объявление и вычисление констант.
- Проверку недопустимых имен.
- Обработку неопределенных констант.


### 3. Команды для сборки проекта

#### Установка зависимостей

Убедитесь, что у вас установлен Python 3. Рекомендуется использовать виртуальное окружение для изоляции проекта.

1. Создайте виртуальное окружение:
```python3 -m venv venv```
2. Активируйте виртуальное окружение:
- На Unix/Linux/MacOS:
```source venv/bin/activate```
- На Windows:
```venv\Scripts\activate```
3. Установите необходимые зависимости:
```pip install -r requirements.txt```

#### Запуск конвертера

Используйте следующую команду для запуска скрипта:
```python3 converter.py -o <путь_к_выходному_файлу> < input.toml```

Пример:
```python3 converter.py -o output.txt < input.toml```

#### Запуск тестов

Для запуска тестов выполните команду:
```pytest test_converter.py```


### 4. Примеры использования

#### Пример 1: Конфигурация веб-сервера

Файл web_server_config.toml:
```
[server]
port = 8080
host = "localhost"

[server.settings]
enable_ssl = false
max_connections = 100

[paths]
static = "/var/www/static"
templates = "/var/www/templates"
```

**Команда для запуска:**
```python3 converter.py -o web_server_config.txt < web_server_config.toml```

**Результат в web_server_config.txt:**
```
dict(
    server = dict(
        port = 8080,
        host = @"localhost",
        settings = dict(
            enable_ssl = @"False",
            max_connections = 100
        )
    ),
    paths = dict(
        static = @"/var/www/static",
        templates = @"/var/www/templates"
    )
)
```

#### Пример 2: Конфигурация модели машинного обучения

Файл ml_model_config.toml:
```
[model]
name = "ImageClassifier"
version = "1.0"

[model.parameters]
learning_rate = 0.001
batch_size = 64
num_epochs = 10

[model.layers]
type = ["conv", "pool", "dense"]
num_units = [32, 64, 128]

[constants]
const_decl = "0.001 -> lr"
const_eval = "|lr| = learning_rate"
```

**Команда для запуска:**
```python3 converter.py -o ml_model_config.txt < ml_model_config.toml```

**Результат в ml_model_config.txt:**
```
dict(
    model = dict(
        name = @"ImageClassifier",
        version = @"1.0",
        parameters = dict(
            learning_rate = 0.001,
            batch_size = 64,
            num_epochs = 10
        ),
        layers = dict(
            type = [ @"conv" @"pool" @"dense" ],
            num_units = [ 32 64 128 ]
        )
    ),
    constants = dict(
        const_decl = 0.001 -> lr,
        const_eval = @"|lr| = learning_rate"
    )
)
```

#### Пример 3: Объявление и использование констант

Файл constants_example.toml:
```
[constants]
const_decl = "Hello World -> greeting"
const_usage = "|greeting|"
```

**Команда для запуска:**
```python3 converter.py -o constants_output.txt < constants_example.toml```

**Результат в constants_output.txt:**
```
dict(
    constants = dict(
        const_decl = @"Hello World" -> greeting,
        const_usage = |greeting|
    )
)
```


### 5. Результаты прогона тестов

Для проверки корректности работы программы запустите тесты с помощью pytest.

**Команда для запуска тестов:**
```pytest test_converter.py```

**Вывод при прохождении тестов:**
```
======================= test session starts ========================
platform darwin -- Python 3.13.0, pytest-8.3.4, pluggy-1.5.0
rootdir: /Users/andrey/Documents/Config-3
collected 9 items                                                  

test_converter.py .........                                  [100%]

======================== 9 passed in 0.01s =========================
```

Все тесты проходят успешно, что подтверждает правильность работы всех функций и соответствие требованиям задания.

---

Ссылка на git-репозиторий: <https://github.com/e-and-a/Config-3>